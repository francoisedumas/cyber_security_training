<%= content_for :header_link do %>
  <a href="https://owasp.org/www-community/attacks/xss/" target="blank" class="text-sm font-semibold leading-6 text-gray-900">Plus d'info <span aria-hidden="true">&rarr;</span></a>
<% end %>

<div class="bg-white px-6 py-12 sm:py-12 lg:px-8">
  <div class="mx-auto max-w-2xl text-center">
    <h3 class="text-4xl font-bold tracking-tight text-gray-900">Cross-Site Scripting (XSS)</h3>
    <p class="mt-6 text-lg leading-8 text-gray-600">Il s'agit d'une vulnérabilité permettant aux attaquants d'injecter du code nuisible dans un site web. Ce code s'exécute dans le navigateur d'une victime, ce qui peut entraîner le vol de données sensibles telles que les informations de connexion</p>
    <p class="mt-6 text-lg leading-8 text-gray-600">La prévention des XSS implique de nettoyer le contenu généré par les utilisateurs. Exemple essayez <code>sanitize(link_to("Click!", target))</code></p>
  </div>
</div>

<div class="bg-white shadow sm:rounded-lg flex justify-center">
  <div class="px-4 py-5 sm:p-6">
    <div class="mt-2 max-w-xl text-sm text-gray-500">
      <p>Essayez avec JS code: <code>javascript:alert('XSS Attack!')</code></p>
    </div>
    <%= form_with model: @link, class:"mt-5 sm:flex sm:items-center" do |form| %>
      <div class="w-full sm:max-w-xs">
          <%= form.label :target, "target",  class:"sr-only" %>
          <%= form.text_field :target, placeholder:"your injection!" , class: "block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"%>
      </div>
      <%= form.button "Enregistrer", class: "mt-3 inline-flex w-full items-center justify-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 sm:ml-3 sm:mt-0 sm:w-auto" %>
    <% end %>
  </div>
</div>

<div class="max-w-4xl  mx-auto p-4 my-8">
  <div class="border-b border-gray-200 bg-white px-4 py-5 sm:px-6">
    <h3 class="text-base font-semibold leading-6 text-gray-900">Links</h3>
    <p class="mt-1 text-sm text-gray-500">Liste de vos liens.</p>
  </div>
  <% if @links.any? %>
    <ul role="list" class="divide-y divide-gray-100">
      <% @links.each do |link| %>
        <%= render "safe_link", link: link %>
        <%= render "unsafe_link", link: link %>
      <% end %>
    </ul>
  <% else %>
    <p class="mt-1 truncate text-xs leading-5 text-gray-500">Commencez par créer un lien</p>
  <% end %>
</div>
